<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Preview</title>
        <style>
            .preview-container {
                display: grid;
                place-items: center;
                margin-top: 20px;
                width: 200px;
                height: 200px;
                border-radius: 10px;
                background-color: lightgray;
            }
            
            form {
                display: flex;
                flex-direction: column;
                gap: 10px;
                max-width: 300px;
                margin: 0 auto;
            }

            label, select {
                margin: 5px 0;
            }

            select:focus {
                outline: none;
                border: 2px solid #0091EA;
                box-shadow: 0 0 5px #60abda;
            }

            .html-output {
                margin-top: 20px;
                padding: 10px;
                border: 1px solid #ddd;
                border-radius: 5px;
                white-space: pre-wrap;
            }
        </style>
    </head>
    <body>
        <div class="preview-container" id="preview-container">
            <!-- Preview will be displayed here -->
        </div>
        <div class="html-output" id="html-output">
            <!-- HTML code will be displayed here -->
        </div>

        <script>
            const vscode = acquireVsCodeApi();
            window.addEventListener('message', event => {
                const message = event.data;
                const previewContainer = document.getElementById('preview-container');
                const htmlOutput = document.getElementById('html-output');
                previewContainer.innerHTML = ''; // Clear previous preview

                if (message.command === 'generate') {
                    const { componentType, color, borderRadius } = message;
                    const borderRadiusMap = {
                        'none': '0px',
                        'small': '5px',
                        'medium': '10px',
                        'large': '15px'
                    };

                    if (componentType === 'button') {
                        const button = document.createElement('button');
                        button.style.zIndex = 1000;
                        button.textContent = 'Button';
                        button.style.backgroundColor = color;
                        button.style.borderRadius = borderRadiusMap[borderRadius];
                        previewContainer.appendChild(button);
                        htmlFormatter(button.outerHTML, htmlOutput);
                    }

                    // Add more component generation logic as needed
                }
            });

            /**
             * Pretty-prints the component's HTML code
             * @param html: string;  A string object containing the HTML code
             * @param htmlContainer: HTMLElement;  An HTML element that will display the HTML code
             */
            function htmlFormatter(html, htmlContainer) {
                let formattedHtml = "";
                let parsedHtml = html.split('');

                for (let i = 0; i < parsedHtml.length; i++) {
                    if (parsedHtml[i] == ">") {
                        formattedHtml += parsedHtml[i] + "\n\t";
                    }
                    else if (parsedHtml[i] == "<" && parsedHtml[i + 1] == "/") {
                        formattedHtml += "\n" + parsedHtml[i++] + parsedHtml[i];
                    }
                    else {
                        formattedHtml += parsedHtml[i];
                    }
                }

                formattedHtml = formattedHtml.substring(0, formattedHtml.length - 1);
                htmlContainer.textContent = formattedHtml;
            }
        </script>
    </body>
</html>
